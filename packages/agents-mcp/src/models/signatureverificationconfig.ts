/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod";
import { ClosedEnum } from "../types/enums.js";
import { ComponentJoin, ComponentJoin$zodSchema } from "./componentjoin.js";
import {
  SignatureSource,
  SignatureSource$zodSchema,
} from "./signaturesource.js";
import {
  SignatureValidationOptions,
  SignatureValidationOptions$zodSchema,
} from "./signaturevalidationoptions.js";
import {
  SignedComponent,
  SignedComponent$zodSchema,
} from "./signedcomponent.js";

/**
 * HMAC algorithm to use for signature verification
 */
export const SignatureVerificationConfigAlgorithm = {
  Sha256: "sha256",
  Sha512: "sha512",
  Sha384: "sha384",
  Sha1: "sha1",
  Md5: "md5",
} as const;
/**
 * HMAC algorithm to use for signature verification
 */
export type SignatureVerificationConfigAlgorithm = ClosedEnum<
  typeof SignatureVerificationConfigAlgorithm
>;

export const SignatureVerificationConfigAlgorithm$zodSchema = z.enum([
  "sha256",
  "sha512",
  "sha384",
  "sha1",
  "md5",
]).describe("HMAC algorithm to use for signature verification");

/**
 * Encoding format of the signature (hex or base64)
 */
export const SignatureVerificationConfigEncoding = {
  Hex: "hex",
  Base64: "base64",
} as const;
/**
 * Encoding format of the signature (hex or base64)
 */
export type SignatureVerificationConfigEncoding = ClosedEnum<
  typeof SignatureVerificationConfigEncoding
>;

export const SignatureVerificationConfigEncoding$zodSchema = z.enum([
  "hex",
  "base64",
]).describe("Encoding format of the signature (hex or base64)");

export type SignatureVerificationConfig = {
  algorithm: SignatureVerificationConfigAlgorithm;
  encoding: SignatureVerificationConfigEncoding;
  signature: SignatureSource;
  signedComponents: Array<SignedComponent>;
  componentJoin: ComponentJoin;
  validation?: SignatureValidationOptions | undefined;
};

export const SignatureVerificationConfig$zodSchema: z.ZodType<
  SignatureVerificationConfig
> = z.object({
  algorithm: SignatureVerificationConfigAlgorithm$zodSchema,
  componentJoin: ComponentJoin$zodSchema,
  encoding: SignatureVerificationConfigEncoding$zodSchema,
  signature: SignatureSource$zodSchema,
  signedComponents: z.array(SignedComponent$zodSchema),
  validation: SignatureValidationOptions$zodSchema.optional(),
});
