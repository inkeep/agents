name: Mark stale pull requests

on:
  schedule:
    # Run daily at midnight UTC
    - cron: "0 0 * * *"
  workflow_dispatch:
    # Allow manual triggering for testing

permissions:
  pull-requests: write
  issues: write
  contents: write

jobs:
  stale:
    runs-on: ubuntu-latest

    steps:
      - name: Mark stale pull requests
        uses: actions/stale@v10
        with:
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had recent activity. 
            It will be closed in 7 days if no further activity occurs.

            If this PR is still relevant:
            - Rebase it on the latest main branch
            - Add a comment explaining its current status
            - Request a review if it's ready

            Thank you for your contributions!

          close-pr-message: |
            This pull request has been automatically closed due to inactivity.

            If you'd like to continue working on this, please:
            1. Create a new branch from the latest main
            2. Cherry-pick your commits or rebase your changes
            3. Open a new pull request

            Thank you for your understanding!

          days-before-pr-stale: 7
          days-before-pr-close: 7
          stale-pr-label: "stale"
          exempt-pr-labels: "pinned,security,work-in-progress"
          exempt-draft-pr: true
          exempt-all-pr-assignees: true
          delete-branch: true
          sort-by: "updated"

          days-before-issue-stale: -1
          days-before-issue-close: -1
