#!/bin/sh
# Pre-push hook for Agent Framework
#
# This hook runs before each push to ensure code quality.
# It runs a single optimized turbo command (pnpm check:husky) that:
#   - Builds once (cached and reused by all tasks)
#   - Runs lint, typecheck, and test in parallel after build
#   - Then runs create-agents E2E tests
#
# Usage:
#   Normal push:                      git push
#   Skip all hooks (use sparingly):   git push --no-verify
#
# For more information, see CONTRIBUTING.md

echo "üöÄ Running pre-push checks..."
echo "   Step 1: pnpm check:husky (build, lint, typecheck, unit tests)"

# Run the unified check command
if ! pnpm check:husky; then
  echo "‚ùå Pre-push checks failed. Fix the issues above before pushing."
  echo "   Run 'pnpm check:husky' locally to reproduce."
  exit 1
fi